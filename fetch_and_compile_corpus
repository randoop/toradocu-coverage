#!/bin/bash

set -e
set -x

CORPUSDIR=toradocu
mkdir -p $CORPUSDIR/logs
for dirname in $CORPUSDIR/*; do
  [ -d "$dirname" ] || continue

  basename=`basename $dirname`
  log="../logs/$basename-fetch-log.txt"

  if [[ -e "$dirname/build.gradle" ]]; then
    echo "fetching $basename"
    (cd $dirname; ./gradlew prepareForRandoop 2>&1 | tee $log)
  fi
done
